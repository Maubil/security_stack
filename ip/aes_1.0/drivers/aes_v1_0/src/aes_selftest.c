
/***************************** Include Files *******************************/
#include "aes.h"
#include "xparameters.h"
#include "xil_io.h"

/************************** Constant Definitions ***************************/
#define READ_WRITE_MUL_FACTOR 0x10

#define ASSERT_RESULT(rc, i, result, expected) if (cmp_result(rc, i, result, expected) != XST_SUCCESS) return XST_FAILURE

static XStatus cmp_result(XStatus rc, size_t iteration, u32 result[4], u32 expected[4]);

/************************** Function Definitions ***************************/
/**
 *
 * Run a self-test on the device
 *
 * @param   baseaddr_p is the base address of the AESinstance to be worked on.
 *
 * @return
 *
 *    - XST_SUCCESS   if all self-test code passed
 *    - XST_FAILURE   if any self-test code failed
 *
 */
XStatus AES_SelfTest(void * baseaddr_p)
{

	aes_set_addr((u32) baseaddr_p);

	xil_printf("****************************\n\r");
	xil_printf("* AES Peripheral Self Test *\n\r");
	xil_printf("****************************\n\n\r");

	xil_printf("[AES] Using the official NIST test vectors\n\r");
	xil_printf("[AES] https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/aes/AESAVS.pdf\n\r");
	xil_printf("[AES] Values from Appendix D. VarTxt Known Answer Test Values\n\r\n\r");
	u32 key[8] = {0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000};
	u32 plaintextes[128][4] = {
		{0x80000000, 0x00000000, 0x00000000, 0x00000000},{0xc0000000, 0x00000000, 0x00000000, 0x00000000},{0xe0000000, 0x00000000, 0x00000000, 0x00000000},{0xf0000000, 0x00000000, 0x00000000, 0x00000000},{0xf8000000, 0x00000000, 0x00000000, 0x00000000},{0xfc000000, 0x00000000, 0x00000000, 0x00000000},
		{0xfe000000, 0x00000000, 0x00000000, 0x00000000},{0xff000000, 0x00000000, 0x00000000, 0x00000000},{0xff800000, 0x00000000, 0x00000000, 0x00000000},{0xffc00000, 0x00000000, 0x00000000, 0x00000000},{0xffe00000, 0x00000000, 0x00000000, 0x00000000},{0xfff00000, 0x00000000, 0x00000000, 0x00000000},
		{0xfff80000, 0x00000000, 0x00000000, 0x00000000},{0xfffc0000, 0x00000000, 0x00000000, 0x00000000},{0xfffe0000, 0x00000000, 0x00000000, 0x00000000},{0xffff0000, 0x00000000, 0x00000000, 0x00000000},{0xffff8000, 0x00000000, 0x00000000, 0x00000000},{0xffffc000, 0x00000000, 0x00000000, 0x00000000},
		{0xffffe000, 0x00000000, 0x00000000, 0x00000000},{0xfffff000, 0x00000000, 0x00000000, 0x00000000},{0xfffff800, 0x00000000, 0x00000000, 0x00000000},{0xfffffc00, 0x00000000, 0x00000000, 0x00000000},{0xfffffe00, 0x00000000, 0x00000000, 0x00000000},{0xffffff00, 0x00000000, 0x00000000, 0x00000000},
		{0xffffff80, 0x00000000, 0x00000000, 0x00000000},{0xffffffc0, 0x00000000, 0x00000000, 0x00000000},{0xffffffe0, 0x00000000, 0x00000000, 0x00000000},{0xfffffff0, 0x00000000, 0x00000000, 0x00000000},{0xfffffff8, 0x00000000, 0x00000000, 0x00000000},{0xfffffffc, 0x00000000, 0x00000000, 0x00000000},
		{0xfffffffe, 0x00000000, 0x00000000, 0x00000000},{0xffffffff, 0x00000000, 0x00000000, 0x00000000},{0xffffffff, 0x80000000, 0x00000000, 0x00000000},{0xffffffff, 0xc0000000, 0x00000000, 0x00000000},{0xffffffff, 0xe0000000, 0x00000000, 0x00000000},{0xffffffff, 0xf0000000, 0x00000000, 0x00000000},
		{0xffffffff, 0xf8000000, 0x00000000, 0x00000000},{0xffffffff, 0xfc000000, 0x00000000, 0x00000000},{0xffffffff, 0xfe000000, 0x00000000, 0x00000000},{0xffffffff, 0xff000000, 0x00000000, 0x00000000},{0xffffffff, 0xff800000, 0x00000000, 0x00000000},{0xffffffff, 0xffc00000, 0x00000000, 0x00000000},
		{0xffffffff, 0xffe00000, 0x00000000, 0x00000000},{0xffffffff, 0xfff00000, 0x00000000, 0x00000000},{0xffffffff, 0xfff80000, 0x00000000, 0x00000000},{0xffffffff, 0xfffc0000, 0x00000000, 0x00000000},{0xffffffff, 0xfffe0000, 0x00000000, 0x00000000},{0xffffffff, 0xffff0000, 0x00000000, 0x00000000},
		{0xffffffff, 0xffff8000, 0x00000000, 0x00000000},{0xffffffff, 0xffffc000, 0x00000000, 0x00000000},{0xffffffff, 0xffffe000, 0x00000000, 0x00000000},{0xffffffff, 0xfffff000, 0x00000000, 0x00000000},{0xffffffff, 0xfffff800, 0x00000000, 0x00000000},{0xffffffff, 0xfffffc00, 0x00000000, 0x00000000},
		{0xffffffff, 0xfffffe00, 0x00000000, 0x00000000},{0xffffffff, 0xffffff00, 0x00000000, 0x00000000},{0xffffffff, 0xffffff80, 0x00000000, 0x00000000},{0xffffffff, 0xffffffc0, 0x00000000, 0x00000000},{0xffffffff, 0xffffffe0, 0x00000000, 0x00000000},{0xffffffff, 0xfffffff0, 0x00000000, 0x00000000},
		{0xffffffff, 0xfffffff8, 0x00000000, 0x00000000},{0xffffffff, 0xfffffffc, 0x00000000, 0x00000000},{0xffffffff, 0xfffffffe, 0x00000000, 0x00000000},{0xffffffff, 0xffffffff, 0x00000000, 0x00000000},{0xffffffff, 0xffffffff, 0x80000000, 0x00000000},{0xffffffff, 0xffffffff, 0xc0000000, 0x00000000},
		{0xffffffff, 0xffffffff, 0xe0000000, 0x00000000},{0xffffffff, 0xffffffff, 0xf0000000, 0x00000000},{0xffffffff, 0xffffffff, 0xf8000000, 0x00000000},{0xffffffff, 0xffffffff, 0xfc000000, 0x00000000},{0xffffffff, 0xffffffff, 0xfe000000, 0x00000000},{0xffffffff, 0xffffffff, 0xff000000, 0x00000000},
		{0xffffffff, 0xffffffff, 0xff800000, 0x00000000},{0xffffffff, 0xffffffff, 0xffc00000, 0x00000000},{0xffffffff, 0xffffffff, 0xffe00000, 0x00000000},{0xffffffff, 0xffffffff, 0xfff00000, 0x00000000},{0xffffffff, 0xffffffff, 0xfff80000, 0x00000000},{0xffffffff, 0xffffffff, 0xfffc0000, 0x00000000},
		{0xffffffff, 0xffffffff, 0xfffe0000, 0x00000000},{0xffffffff, 0xffffffff, 0xffff0000, 0x00000000},{0xffffffff, 0xffffffff, 0xffff8000, 0x00000000},{0xffffffff, 0xffffffff, 0xffffc000, 0x00000000},{0xffffffff, 0xffffffff, 0xffffe000, 0x00000000},{0xffffffff, 0xffffffff, 0xfffff000, 0x00000000},
		{0xffffffff, 0xffffffff, 0xfffff800, 0x00000000},{0xffffffff, 0xffffffff, 0xfffffc00, 0x00000000},{0xffffffff, 0xffffffff, 0xfffffe00, 0x00000000},{0xffffffff, 0xffffffff, 0xffffff00, 0x00000000},{0xffffffff, 0xffffffff, 0xffffff80, 0x00000000},{0xffffffff, 0xffffffff, 0xffffffc0, 0x00000000},
		{0xffffffff, 0xffffffff, 0xffffffe0, 0x00000000},{0xffffffff, 0xffffffff, 0xfffffff0, 0x00000000},{0xffffffff, 0xffffffff, 0xfffffff8, 0x00000000},{0xffffffff, 0xffffffff, 0xfffffffc, 0x00000000},{0xffffffff, 0xffffffff, 0xfffffffe, 0x00000000},{0xffffffff, 0xffffffff, 0xffffffff, 0x00000000},
		{0xffffffff, 0xffffffff, 0xffffffff, 0x80000000},{0xffffffff, 0xffffffff, 0xffffffff, 0xc0000000},{0xffffffff, 0xffffffff, 0xffffffff, 0xe0000000},{0xffffffff, 0xffffffff, 0xffffffff, 0xf0000000},{0xffffffff, 0xffffffff, 0xffffffff, 0xf8000000},{0xffffffff, 0xffffffff, 0xffffffff, 0xfc000000},
		{0xffffffff, 0xffffffff, 0xffffffff, 0xfe000000},{0xffffffff, 0xffffffff, 0xffffffff, 0xff000000},{0xffffffff, 0xffffffff, 0xffffffff, 0xff800000},{0xffffffff, 0xffffffff, 0xffffffff, 0xffc00000},{0xffffffff, 0xffffffff, 0xffffffff, 0xffe00000},{0xffffffff, 0xffffffff, 0xffffffff, 0xfff00000},
		{0xffffffff, 0xffffffff, 0xffffffff, 0xfff80000},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffc0000},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffe0000},{0xffffffff, 0xffffffff, 0xffffffff, 0xffff0000},{0xffffffff, 0xffffffff, 0xffffffff, 0xffff8000},{0xffffffff, 0xffffffff, 0xffffffff, 0xffffc000},
		{0xffffffff, 0xffffffff, 0xffffffff, 0xffffe000},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffff000},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffff800},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffffc00},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffffe00},{0xffffffff, 0xffffffff, 0xffffffff, 0xffffff00},
		{0xffffffff, 0xffffffff, 0xffffffff, 0xffffff80},{0xffffffff, 0xffffffff, 0xffffffff, 0xffffffc0},{0xffffffff, 0xffffffff, 0xffffffff, 0xffffffe0},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffffff0},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffffff8},{0xffffffff, 0xffffffff, 0xffffffff, 0xfffffffc},
		{0xffffffff, 0xffffffff, 0xffffffff, 0xfffffffe},{0xffffffff, 0xffffffff, 0xffffffff, 0xffffffff}
	};
	u32 ciphertext_128bit[128][4] = {
		{0x3ad78e72, 0x6c1ec02b, 0x7ebfe92b, 0x23d9ec34},{0xaae5939c, 0x8efdf2f0, 0x4e60b9fe, 0x7117b2c2},{0xf031d4d7, 0x4f5dcbf3, 0x9daaf8ca, 0x3af6e527},{0x96d9fd5c, 0xc4f07441, 0x727df0f3, 0x3e401a36},{0x30ccdb04, 0x4646d7e1, 0xf3ccea3d, 0xca08b8c0},{0x16ae4ce5, 0x042a67ee, 0x8e177b7c, 0x587ecc82},
		{0xb6da0bb1, 0x1a23855d, 0x9c5cb1b4, 0xc6412e0a},{0xdb4f1aa5, 0x30967d67, 0x32ce4715, 0xeb0ee24b},{0xa8173825, 0x2621dd18, 0x0a34f345, 0x5b4baa2f},{0x77e2b508, 0xdb7fd892, 0x34caf793, 0x9ee5621a},{0xb8499c25, 0x1f8442ee, 0x13f0933b, 0x688fcd19},{0x965135f8, 0xa81f25c9, 0xd630b175, 0x02f68e53},
		{0x8b87145a, 0x01ad1c6c, 0xede995ea, 0x3670454f},{0x8eae3b10, 0xa0c8ca6d, 0x1d3b0fa6, 0x1e56b0b2},{0x64b4d629, 0x810fda6b, 0xafdf08f3, 0xb0d8d2c5},{0xd7e5dbd3, 0x324595f8, 0xfdc7d7c5, 0x71da6c2a},{0xf3f72375, 0x264e167f, 0xca9de2c1, 0x527d9606},{0x8ee79dd4, 0xf401ff9b, 0x7ea945d8, 0x6666c13b},
		{0xdd35cea2, 0x799940b4, 0x0db3f819, 0xcb94c08b},{0x6941cb6b, 0x3e08c2b7, 0xafa581eb, 0xdd607b87},{0x2c20f439, 0xf6bb097b, 0x29b8bd6d, 0x99aad799},{0x625d01f0, 0x58e565f7, 0x7ae86378, 0xbd2c49b3},{0xc0b5fd98, 0x190ef45f, 0xbb430143, 0x8d095950},{0x13001ff5, 0xd99806ef, 0xd25da34f, 0x56be854b},
		{0x3b594c60, 0xf5c8277a, 0x5113677f, 0x94208d82},{0xe9c0fc18, 0x18e4aa46, 0xbd2e39d6, 0x38f89e05},{0xf8023ee9, 0xc3fdc45a, 0x019b4e98, 0x5c7e1a54},{0x35f40182, 0xab4662f3, 0x023baec1, 0xee796b57},{0x3aebbad7, 0x303649b4, 0x194a6945, 0xc6cc3694},{0xa2124bea, 0x53ec2834, 0x279bed7f, 0x7eb0f938},
		{0xb9fb4399, 0xfa4facc7, 0x309e14ec, 0x98360b0a},{0xc2627743, 0x7420c5d6, 0x34f715ae, 0xa81a9132},{0x171a0e1b, 0x2dd424f0, 0xe089af2c, 0x4c10f32f},{0x7cadbe40, 0x2d1b208f, 0xe735edce, 0x00aee7ce},{0x43b02ff9, 0x29a1485a, 0xf6f5c6d6, 0x558baa0f},{0x092faacc, 0x9bf43508, 0xbf8fa861, 0x3ca75dea},
		{0xcb2bf828, 0x0f3f9742, 0xc7ed513f, 0xe802629c},{0x215a41ee, 0x442fa992, 0xa6e32398, 0x6ded3f68},{0xf21e99cf, 0x4f0f77ce, 0xa836e11a, 0x2fe75fb1},{0x95e3a0ca, 0x9079e646, 0x331df8b4, 0xe70d2cd6},{0x4afe7f12, 0x0ce7613f, 0x74fc12a0, 0x1a828073},{0x827f000e, 0x75e2c8b9, 0xd479beed, 0x913fe678},
		{0x35830c8e, 0x7aaefe2d, 0x30310ef3, 0x81cbf691},{0x191aa0f2, 0xc8570144, 0xf38657ea, 0x4085ebe5},{0x85062c2c, 0x909f15d9, 0x269b6c18, 0xce99c4f0},{0x678034dc, 0x9e41b5a5, 0x60ed239e, 0xeab1bc78},{0xc2f93a4c, 0xe5ab6d5d, 0x56f1b93c, 0xf19911c1},{0x1c3112bc, 0xb0c1dcc7, 0x49d79974, 0x3691bf82},
		{0x00c55bd7, 0x5c7f9c88, 0x1989d3ec, 0x1911c0d4},{0xea2e6b5e, 0xf182b7df, 0xf3629abd, 0x6a12045f},{0x22322327, 0xe01780b1, 0x7397f240, 0x87f8cc6f},{0xc9cacb5c, 0xd11692c3, 0x73b24117, 0x68149ee7},{0xa18e3dbb, 0xca577860, 0xdab6b80d, 0xa3139256},{0x79b61c37, 0xbf328ecc, 0xa8d74326, 0x5a3d425c},
		{0xd2d99c6b, 0xcc1f06fd, 0xa8e27e8a, 0xe3f1ccc7},{0x1bfd4b91, 0xc701fd6b, 0x61b7f997, 0x829d663b},{0x11005d52, 0xf25f16bd, 0xc9545a87, 0x6a63490a},{0x3a4d354f, 0x02bb5a5e, 0x47d39666, 0x867f246a},{0xd451b8d6, 0xe1e1a0eb, 0xb155fbbf, 0x6e7b7dc3},{0x6898d4f4, 0x2fa7ba6a, 0x10ac05e8, 0x7b9f2080},
		{0xb611295e, 0x739ca7d9, 0xb50f8e4c, 0x0e754a3f},{0x7d33fc7d, 0x8abe3ca1, 0x936759f8, 0xf5deaf20},{0x3b5e0f56, 0x6dc96c29, 0x8f0c1263, 0x7539b25c},{0xf807c3e7, 0x985fe0f5, 0xa50e2cdb, 0x25c5109e},{0x41f992a8, 0x56fb278b, 0x389a62f5, 0xd274d7e9},{0x10d3ed7a, 0x6fe15ab4, 0xd91acbc7, 0xd0767ab1},
		{0x21feecd4, 0x5b2e6759, 0x73ac33bf, 0x0c5424fc},{0x1480cb39, 0x55ba62d0, 0x9eea668f, 0x7c708817},{0x66404033, 0xd6b72b60, 0x9354d549, 0x6e7eb511},{0x1c317a22, 0x0a7d700d, 0xa2b1e075, 0xb00266e1},{0xab3b8954, 0x2233f127, 0x1bf8fd0c, 0x0f403545},{0xd93eae96, 0x6fac46dc, 0xa927d6b1, 0x14fa3f9e},
		{0x1bdec521, 0x316503d9, 0xd5ee65df, 0x3ea94ddf},{0xeef45643, 0x1dea8b4a, 0xcf83bdae, 0x3717f75f},{0x06f2519a, 0x2fafaa59, 0x6bfef5cf, 0xa15c21b9},{0x251a7eac, 0x7e2fe809, 0xe4aa8d0d, 0x7012531a},{0x3bffc16e, 0x4c49b268, 0xa20f8d96, 0xa60b4058},{0xe886f928, 0x1999c5bb, 0x3b3e8862, 0xe2f7c988},
		{0x563bf90d, 0x61beef39, 0xf48dd625, 0xfcef1361},{0x4d37c850, 0x644563c6, 0x9fd0acd9, 0xa049325b},{0xb87c921b, 0x91829ef3, 0xb13ca541, 0xee1130a6},{0x2e65eb6b, 0x6ea383e1, 0x09accce8, 0x326b0393},{0x9ca547f7, 0x439edc3e, 0x255c0f4d, 0x49aa8990},{0xa5e65261, 0x4c9300f3, 0x7816b1f9, 0xfd0c87f9},
		{0x14954f0b, 0x4697776f, 0x44494fe4, 0x58d814ed},{0x7c8d9ab6, 0xc2761723, 0xfe42f8bb, 0x506cbcf7},{0xdb7e1932, 0x679fdd99, 0x742aab04, 0xaa0d5a80},{0x4c6a1c83, 0xe568cd10, 0xf27c2d73, 0xded19c28},{0x90ecbe61, 0x77e674c9, 0x8de41241, 0x3f7ac915},{0x90684a2a, 0xc55fe1ec, 0x2b8ebd56, 0x22520b73},
		{0x7472f9a7, 0x988607ca, 0x79707795, 0x991035e6},{0x56aff089, 0x878bf335, 0x2f8df172, 0xa3ae47d8},{0x65c0526c, 0xbe40161b, 0x8019a2a3, 0x171abd23},{0x377be0be, 0x33b4e3e3, 0x10b4aabd, 0xa173f84f},{0x9402e9aa, 0x6f69de65, 0x04da8d20, 0xc4fcaa2f},{0x123c1f4a, 0xf313ad8c, 0x2ce648b2, 0xe71fb6e1},
		{0x1ffc626d, 0x30203dcd, 0xb0019fb8, 0x0f726cf4},{0x76da1fbe, 0x3a50728c, 0x50fd2e62, 0x1b5ad885},{0x082eb8be, 0x35f442fb, 0x52668e16, 0xa591d1d6},{0xe656f9ec, 0xf5fe27ec, 0x3e4a73d0, 0x0c282fb3},{0x2ca8209d, 0x63274cd9, 0xa29bb74b, 0xcd77683a},{0x79bf5dce, 0x14bb7dd7, 0x3a8e3611, 0xde7ce026},
		{0x3c849939, 0xa5d29399, 0xf344c4a0, 0xeca8a576},{0xed3c0a94, 0xd59bece9, 0x8835da7a, 0xa4f07ca2},{0x63919ed4, 0xce101964, 0x38b6ad09, 0xd99cd795},{0x7678f3a8, 0x33f19fea, 0x95f3c602, 0x9e2bc610},{0x3aa42683, 0x1067d36b, 0x92be7c5f, 0x81c13c56},{0x9272e2d2, 0xcdd11050, 0x998c8450, 0x77a30ea0},
		{0x088c4b53, 0xf5ec0ff8, 0x14c19ada, 0xe7f6246c},{0x4010a5e4, 0x01fdf0a0, 0x354ddbcc, 0x0d012b17},{0xa87a3857, 0x36c0a618, 0x9bd6589b, 0xd8445a93},{0x545f2b83, 0xd9616dcc, 0xf60fa983, 0x0e9cd287},{0x4b706f7f, 0x92406352, 0x394037a6, 0xd4f4688d},{0xb7972b39, 0x41c44b90, 0xafa7b264, 0xbfba7387},
		{0x6f45732c, 0xf1088154, 0x6f0fd238, 0x96d2bb60},{0x2e3579ca, 0x15af27f6, 0x4b3c955a, 0x5bfc30ba},{0x34a2c5a9, 0x1ae2aec9, 0x9b7d1b5f, 0xa6780447},{0xa4d6616b, 0xd04f8733, 0x5b0e5335, 0x1227a9ee},{0x7f692b03, 0x945867d1, 0x6179a8ce, 0xfc83ea3f},{0x3bd141ee, 0x84a0e641, 0x4a26e7a4, 0xf281f8a2},
		{0xd1788f57, 0x2d98b2b1, 0x6ec5d5f3, 0x922b99bc},{0x0833ff6f, 0x61d98a57, 0xb288e8c3, 0x586b85a6},{0x85682617, 0x97de176b, 0xf0b43bec, 0xc6285afb},{0xf9b0fda0, 0xc4a898f5, 0xb9e6f661, 0xc4ce4d07},{0x8ade8959, 0x13685c67, 0xc5269f8a, 0xae42983e},{0x39bde67d, 0x5c8ed8a8, 0xb1c37eb8, 0xfa9f5ac0},
		{0x5c005e72, 0xc1418c44, 0xf569f2ea, 0x33ba54f3},{0x3f5b8cc9, 0xea855a0a, 0xfa7347d2, 0x3e8d664e},
	};

	u32 ciphertext_256bit[128][4] = {
		{0xddc6bf79, 0x0c15760d, 0x8d9aeb6f, 0x9a75fd4e},{0x0a6bdc6d, 0x4c1e6280, 0x301fd8e9, 0x7ddbe601},{0x9b80eefb, 0x7ebe2d2b, 0x16247aa0, 0xefc72f5d},{0x7f2c5ece, 0x07a98d8b, 0xee13c511, 0x77395ff7},{0x7818d800, 0xdcf6f4be, 0x1e0e94f4, 0x03d1e4c2},{0xe74cd1c9, 0x2f0919c3, 0x5a032412, 0x3d6177d3},
		{0x8092a4dc, 0xf2da7e77, 0xe93bdd37, 0x1dfed82e},{0x49af6b37, 0x2135acef, 0x10132e54, 0x8f217b17},{0x8bcd40f9, 0x4ebb63b9, 0xf7909676, 0xe667f1e7},{0xfe1cffb8, 0x3f45dcfb, 0x38b29be4, 0x38dbd3ab},{0x0dc58a8d, 0x88662370, 0x5aec15cb, 0x1e70dc0e},{0xc218faa1, 0x6056bd07, 0x74c3e8d7, 0x9c35a5e4},
		{0x047bba83, 0xf7aa8417, 0x31504e01, 0x2208fc9e},{0xdc8f0e49, 0x15fd81ba, 0x70a33131, 0x0882f6da},{0x1569859e, 0xa6b7206c, 0x30bf4fd0, 0xcbfac33c},{0x300ade92, 0xf88f48fa, 0x2df730ec, 0x16ef44cd},{0x1fe6cc3c, 0x05965dc0, 0x8eb0590c, 0x95ac71d0},{0x59e858ea, 0xaa97fec3, 0x8111275b, 0x6cf5abc0},
		{0x2239455e, 0x7afe3b06, 0x16100288, 0xcc5a723b},{0x3ee500c5, 0xc8d63479, 0x717163e5, 0x5c5c4522},{0xd5e38bf1, 0x5f16d90e, 0x3e214041, 0xd774daa8},{0xb1f4066e, 0x6f4f187d, 0xfe5f2ad1, 0xb17819d0},{0x6ef4cc4d, 0xe49b1106, 0x5d7af290, 0x9854794a},{0xac86bc60, 0x6b6640c3, 0x09e782f2, 0x32bf367f},
		{0x36aff0ef, 0x7bf32807, 0x72cf4cac, 0x80a0d2b2},{0x1f8eedea, 0x0f62a140, 0x6d58cfc3, 0xecea72cf},{0xabf4154a, 0x3375a1d3, 0xe6b1d454, 0x438f95a6},{0x96f96e9d, 0x607f6615, 0xfc192061, 0xee648b07},{0xcf37cdaa, 0xa0d2d536, 0xc7185763, 0x4c792064},{0xfbd6640c, 0x80245c2b, 0x805373f1, 0x30703127},
		{0x8d6a8afe, 0x55a6e481, 0xbadae0d1, 0x46f436db},{0x6a4981f2, 0x915e3e68, 0xaf6c2238, 0x5dd06756},{0x42a1136e, 0x5f8d8d21, 0xd3101998, 0x642d573b},{0x9b471596, 0xdc69ae15, 0x86cee615, 0x8b0b0181},{0x753665c4, 0xaf1eff33, 0xaa8b628b, 0xf8741cfd},{0x9a682acf, 0x40be01f5, 0xb2a4193c, 0x9a82404d},
		{0x54fafe26, 0xe4287f17, 0xd1935f87, 0xeb9ade01},{0x49d541b2, 0xe74cfe73, 0xe6a8e822, 0x5f7bd449},{0x11a45530, 0xf624ff6f, 0x76a1b382, 0x6626ff7b},{0xf96b0c4a, 0x8bc6c861, 0x30289f60, 0xb43b8fba},{0x48c7d0e8, 0x0834ebdc, 0x35b6735f, 0x76b46c8b},{0x2463531a, 0xb54d6695, 0x5e73edc4, 0xcb8eaa45},
		{0xac9bd8e2, 0x53046913, 0x4b9d5b06, 0x5d4f565b},{0x3f5f9106, 0xd0e52f97, 0x3d4890e6, 0xf37e8a00},{0x20ebc86f, 0x1304d272, 0xe2e207e5, 0x9db639f0},{0xe67ae642, 0x6bf9526c, 0x972cff07, 0x2b52252c},{0x1a518ddd, 0xaf9efa0d, 0x002cc58d, 0x107edfc8},{0xead731af, 0x4d3a2fe3, 0xb34bed04, 0x7942a49f},
		{0xb1d4efe4, 0x0242f83e, 0x93b6c8d7, 0xefb5eae9},{0xcd2b1fec, 0x11fd906c, 0x5c763009, 0x9443610a},{0xa1853fe4, 0x7fe29289, 0xd153161d, 0x06387d21},{0x46321541, 0x79a555c1, 0x7ea604d0, 0x889fab14},{0xdd27cac6, 0x401a022e, 0x8f38f9f9, 0x3e774417},{0xc090313e, 0xb98674f3, 0x5f312338, 0x5fb95d4d},
		{0xcc352626, 0x2b92f02e, 0xdce548f7, 0x16b9f45c},{0xc0838d1a, 0x2b16a7c7, 0xf0dfcc43, 0x3c399c33},{0x0d9ac756, 0xeb297695, 0xeed4d382, 0xeb126d26},{0x56ede9dd, 0xa3f6f141, 0xbff1757f, 0xa689c3e1},{0x768f520e, 0xfe0f23e6, 0x1d3ec8ad, 0x9ce91774},{0xb1144ddf, 0xa7575521, 0x3390e7c5, 0x96660490},
		{0x1d7c0c40, 0x40b355b9, 0xd107a993, 0x25e3b050},{0xd8e2bb1a, 0xe8ee3dcf, 0x5bf7d6c3, 0x8da82a1a},{0xfaf82d17, 0x8af25a98, 0x86a47e7f, 0x789b98d7},{0x9b58dbfd, 0x77fe5aca, 0x9cfc190c, 0xd1b82d19},{0x77f39208, 0x9042e478, 0xac16c0c8, 0x6a0b5db5},{0x19f08e34, 0x20ee69b4, 0x77ca1420, 0x281c4782},
		{0xa1b19bee, 0xe4e11713, 0x9f74b3c5, 0x3fdcb875},{0xa37a5869, 0xb218a9f3, 0xa0868d19, 0xaea0ad6a},{0xbc3594e8, 0x65bcd026, 0x1b132027, 0x31f33580},{0x811441ce, 0x1d309eee, 0x7185e8c7, 0x52c07557},{0x959971ce, 0x41341905, 0x63518e70, 0x0b9874d1},{0x76b5614a, 0x042707c9, 0x8e2132e2, 0xe805fe63},
		{0x7d9fa6a5, 0x7530d0f0, 0x36fec31c, 0x230b0cc6},{0x964153a8, 0x3bf6989a, 0x4ba80daa, 0x91c3e081},{0xa013014d, 0x4ce8054c, 0xf2591d06, 0xf6f2f176},{0xd1c5f639, 0x9bf38250, 0x2e385eee, 0x1474a869},{0x0007e20b, 0x8298ec35, 0x4f0f5fe7, 0x470f36bd},{0xb95ba05b, 0x332da61e, 0xf63a2b31, 0xfcad9879},
		{0x4620a49b, 0xd9674915, 0x61669ab2, 0x5dce45f4},{0x12e71214, 0xae8e04f0, 0xbb63d742, 0x5c6f14d5},{0x4cc42fc1, 0x407b008f, 0xe350907c, 0x092e80ac},{0x08b244ce, 0x7cbc8ee9, 0x7fbba808, 0xcb146fda},{0x39b333e8, 0x694f2154, 0x6ad1edd9, 0xd87ed95b},{0x3b271f8a, 0xb2e6e4a2, 0x0ba8090f, 0x43ba78f3},
		{0x9ad983f3, 0xbf651cd0, 0x393f0a73, 0xcccdea50},{0x8f476cbf, 0xf75c1f72, 0x5ce18e4b, 0xbcd19b32},{0x905b6267, 0xf1d6ab53, 0x20835a13, 0x3f096f2a},{0x145b60d6, 0xd0193c23, 0xf4221848, 0xa892d61a},{0x55cfb3fb, 0x6d75cad0, 0x445bbc8d, 0xafa25b0f},{0x7b8e7098, 0xe357ef71, 0x237d46d8, 0xb075b0f5},
		{0x2bf27229, 0x901eb40f, 0x2df9d839, 0x8d1505ae},{0x83a63402, 0xa77f9ad5, 0xc1e931a9, 0x31ecd706},{0x6f8ba652, 0x1152d31f, 0x2bada184, 0x3e26b973},{0xe5c3b8e3, 0x0fd2d8e6, 0x239b17b4, 0x4bd23bbd},{0x1ac1f710, 0x2c59933e, 0x8b2ddc3f, 0x14e94baa},{0x21d9ba49, 0xf276b45f, 0x11af8fc7, 0x1a088e3d},
		{0x649f1cdd, 0xc3792b46, 0x38635a39, 0x2bc9bade},{0xe2775e4b, 0x59c1bc2e, 0x31a2078c, 0x11b5a08c},{0x2be1fae5, 0x048a2558, 0x2a679ca1, 0x0905eb80},{0xda86f292, 0xc6f41ea3, 0x4fb2068d, 0xf75ecc29},{0x220df19f, 0x85d69b1b, 0x562fa69a, 0x3c5beca5},{0x1f11d5d0, 0x355e0b55, 0x6ccdb6c7, 0xf5083b4d},
		{0x62526b78, 0xbe79cb38, 0x4633c91f, 0x83b4151b},{0x90ddbcb9, 0x50843592, 0xdd47bbef, 0x00fdc876},{0x2fd0e41c, 0x5b840227, 0x7354a739, 0x1d2618e2},{0x3cdf13e7, 0x2dee4c58, 0x1bafec70, 0xb85f9660},{0xafa2ffc1, 0x37577092, 0xe2b654fa, 0x199d2c43},{0x8d683ee6, 0x3e60d208, 0xe343ce48, 0xdbc44cac},
		{0x705a4ef8, 0xba213372, 0x9c20185c, 0x3d3a4763},{0x0861a861, 0xc3db4e94, 0x194211b7, 0x7ed761b9},{0x4b00c27e, 0x8b26da7e, 0xab9d3a88, 0xdec8b031},{0x5f397bf0, 0x3084820c, 0xc8810d52, 0xe5b666e9},{0x63fafabb, 0x72c07bfb, 0xd3ddc9b1, 0x203104b8},{0x683e2140, 0x585b1845, 0x2dd4ffbb, 0x93c95df9},
		{0x286894e4, 0x8e537f87, 0x63b56707, 0xd7d155c8},{0xa423deab, 0xc173dcf7, 0xe2c4c53e, 0x77d37cd1},{0xeb816831, 0x3e1cfdfd, 0xb5e986d5, 0x429cf172},{0x27127daa, 0xfc9accd2, 0xfb334ec3, 0xeba52323},{0xee0715b9, 0x6f72e3f7, 0xa22a5064, 0xfc592f4c},{0x29ee5267, 0x70f2a11d, 0xcfa989d1, 0xce88830f},
		{0x0493370e, 0x054b0987, 0x1130fe49, 0xaf730a5a},{0x9b7b940f, 0x6c509f9e, 0x44a4ee14, 0x0448ee46},{0x2915be4a, 0x1ecfdcbe, 0x3e023811, 0xa12bb6c7},{0x7240e524, 0xbc51d8c4, 0xd440b1be, 0x55d1062c},{0xda63039d, 0x38cb4612, 0xb2dc36ba, 0x26684b93},{0x0f59cb5a, 0x4b522e2a, 0xc56c1a64, 0xf558ad9a},
		{0x7bfe9d87, 0x6c6d63c1, 0xd035da8f, 0xe21c409d},{0xacdace80, 0x78a32b1a, 0x182bfa49, 0x87ca1347}
	};

	if (aes_init_key(key, AES_128_BIT_KEY) != XST_SUCCESS)
	{
		return XST_FAILURE;
	}

	xil_printf("[AES] Running 128bit encryption test...\n\r");

	for(size_t i = 0; i < 128; i++)
	{
		u32 result[4] = {};
		ASSERT_RESULT(aes(plaintextes[i], result, AES_128_BIT_KEY, AES_ENCIPHER), i, result, ciphertext_128bit[i]);
	}

	if (aes_init_key(key, AES_128_BIT_KEY) != XST_SUCCESS)
	{
		return XST_FAILURE;
	}

	xil_printf("[AES] Running 128bit decryption test...\n\r");

	for(size_t i = 0; i < 128; i++)
	{
		u32 result[4] = {};
		ASSERT_RESULT(aes(ciphertext_128bit[i], result, AES_128_BIT_KEY, AES_DECIPHER), i, result, plaintextes[i]);
	}

	if (aes_init_key(key, AES_256_BIT_KEY) != XST_SUCCESS)
	{
		return XST_FAILURE;
	}

	xil_printf("[AES] Running 256bit encryption test...\n\r");

	for(size_t i = 0; i < 128; i++)
	{
		u32 result[4] = {};
		ASSERT_RESULT(aes(plaintextes[i], result, AES_256_BIT_KEY, AES_ENCIPHER), i, result, ciphertext_256bit[i]);
	}

	xil_printf("[AES] Running 256bit decryption test...\n\r");

	for(size_t i = 0; i < 128; i++)
	{
		u32 result[4] = {};
		ASSERT_RESULT(aes(ciphertext_256bit[i], result, AES_256_BIT_KEY, AES_DECIPHER), i, result, plaintextes[i]);
	}

	xil_printf("[AES] SUCCESS!\n\r\n\r");

	return XST_SUCCESS;
}

static XStatus cmp_result(XStatus rc, size_t iteration, u32 result[4], u32 expected[4])
{
	if (rc != XST_SUCCESS)
	{
		xil_printf("[AES] aes() failed with rc 0x%08x\n\r\n\r", rc);
		return XST_FAILURE;
	}

	if (memcmp(result, expected, sizeof(u32) * 4) != 0)
	{
		xil_printf("[AES] Failed at iteration %u\n\r\tExpected\t0x%08x %08x %08x %08x\n\r\tGot\t\t0x%08x %08x %08x %08x\n\r", iteration, expected[0], expected[1], expected[2], expected[3], result[0], result[1], result[2], result[3]);
		return XST_FAILURE;
	}

	return XST_SUCCESS;
}
